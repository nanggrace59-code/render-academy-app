(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{2456:function(e,t,r){Promise.resolve().then(r.bind(r,9792))},9792:function(e,t,r){"use strict";r.r(t),r.d(t,{StudentDashboard:function(){return T}});var l=r(3827),s=r(4090),i=r(7907),n=r(7014),a=r(1708),o=r(4220),c=r(7339),d=r(7898),u=r(7841),x=r(6396),h=r(4395),f=r(3348),m=r(4182),b=r(3758),p=r(7115);function g(e){let{referenceImage:t,renderImage:r,className:i=""}=e,[n,a]=(0,s.useState)("slider"),[g,v]=(0,s.useState)(50),[w,j]=(0,s.useState)(50),[N,y]=(0,s.useState)("render"),k=(0,s.useRef)(null),[_,S]=(0,s.useState)(!1),z=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=()=>S(!!document.fullscreenElement);return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]);let C=e=>{let{icon:t,active:r,onClick:s,title:i}=e;return(0,l.jsx)("button",{onClick:s,title:i,className:"p-1.5 rounded-md transition-all flex items-center justify-center ".concat(r?"bg-[#d90238] text-white shadow-md":"bg-black/60 text-neutral-400 hover:text-white hover:bg-black/80 backdrop-blur-sm border border-white/10"),children:(0,l.jsx)(t,{size:14})})};return(0,l.jsxs)("div",{ref:k,className:"relative bg-[#020202] overflow-hidden rounded-xl border border-white/10 group ".concat(i," ").concat(_?"fixed inset-0 z-[100] rounded-none border-none w-screen h-screen":"w-full h-full"),children:[(0,l.jsxs)("div",{className:"absolute top-3 left-3 z-30 flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[(0,l.jsx)(C,{icon:o.Z,active:"slider"===n,onClick:()=>a("slider"),title:"Slider"}),(0,l.jsx)(C,{icon:c.Z,active:"split"===n,onClick:()=>a("split"),title:"Split"}),(0,l.jsx)(C,{icon:d.Z,active:"overlay"===n,onClick:()=>a("overlay"),title:"Overlay"}),(0,l.jsx)(C,{icon:u.Z,active:"full"===n,onClick:()=>a("full"),title:"Full View"})]}),(0,l.jsxs)("div",{className:"absolute top-3 right-3 z-30 flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 p-1 bg-black/60 backdrop-blur-md rounded-md border border-white/10",children:[(0,l.jsx)("button",{onClick:()=>{var e;return null===(e=z.current)||void 0===e?void 0:e.zoomIn()},className:"p-1 text-neutral-400 hover:text-white",children:(0,l.jsx)(x.Z,{size:14})}),(0,l.jsx)("button",{onClick:()=>{var e;return null===(e=z.current)||void 0===e?void 0:e.zoomOut()},className:"p-1 text-neutral-400 hover:text-white",children:(0,l.jsx)(h.Z,{size:14})}),(0,l.jsx)("button",{onClick:()=>{var e;return null===(e=z.current)||void 0===e?void 0:e.resetTransform()},className:"p-1 text-neutral-400 hover:text-white",children:(0,l.jsx)(f.Z,{size:14})})]}),(0,l.jsx)("button",{onClick:()=>{if(document.fullscreenElement)document.exitFullscreen();else{var e;null===(e=k.current)||void 0===e||e.requestFullscreen()}},className:"p-1.5 bg-black/60 backdrop-blur-md rounded-md border border-white/10 text-neutral-400 hover:text-white hover:bg-[#d90238]",children:_?(0,l.jsx)(m.Z,{size:14}):(0,l.jsx)(b.Z,{size:14})})]}),(0,l.jsx)(p.d$,{ref:z,centerOnInit:!0,minScale:.5,wheel:{step:.1},children:(0,l.jsxs)(p.Uv,{wrapperClass:"w-full h-full",contentClass:"w-full h-full flex items-center justify-center",children:["slider"===n&&(0,l.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center select-none",children:[(0,l.jsx)("img",{src:t,className:"absolute inset-0 w-full h-full object-contain pointer-events-none"}),(0,l.jsx)("div",{className:"absolute inset-0 w-full h-full overflow-hidden",style:{clipPath:"inset(0 ".concat(100-g,"% 0 0)")},children:(0,l.jsx)("img",{src:r,className:"absolute inset-0 w-full h-full object-contain pointer-events-none"})}),(0,l.jsxs)("div",{className:"absolute inset-0 w-full h-full pointer-events-auto",style:{cursor:"ew-resize"},children:[(0,l.jsx)("input",{type:"range",min:"0",max:"100",value:g,onChange:e=>v(Number(e.target.value)),className:"absolute top-0 bottom-0 z-20 w-full h-full opacity-0 cursor-ew-resize"}),(0,l.jsx)("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white/80 shadow-[0_0_10px_rgba(0,0,0,0.5)] pointer-events-none",style:{left:"".concat(g,"%")},children:(0,l.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-6 h-6 bg-white rounded-full flex items-center justify-center text-[#d90238] shadow-lg",children:(0,l.jsx)(o.Z,{size:12,className:"rotate-90"})})})]})]}),"split"===n&&(0,l.jsxs)("div",{className:"flex w-full h-full gap-1 p-2",children:[(0,l.jsxs)("div",{className:"flex-1 relative border border-white/10 rounded overflow-hidden flex items-center justify-center",children:[(0,l.jsx)("img",{src:t,className:"w-full h-full object-contain"}),(0,l.jsx)("span",{className:"absolute top-2 left-2 bg-black/60 text-white text-[9px] px-2 py-0.5 rounded border border-white/10",children:"Reference"})]}),(0,l.jsxs)("div",{className:"flex-1 relative border border-white/10 rounded overflow-hidden flex items-center justify-center",children:[(0,l.jsx)("img",{src:r,className:"w-full h-full object-contain"}),(0,l.jsx)("span",{className:"absolute top-2 left-2 bg-[#d90238] text-white text-[9px] px-2 py-0.5 rounded",children:"Student"})]})]}),"overlay"===n&&(0,l.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[(0,l.jsx)("img",{src:t,className:"absolute inset-0 w-full h-full object-contain"}),(0,l.jsx)("img",{src:r,className:"absolute inset-0 w-full h-full object-contain transition-opacity duration-100",style:{opacity:w/100}})]}),"full"===n&&(0,l.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,l.jsx)("img",{src:"render"===N?r:t,className:"w-full h-full object-contain"})})]})}),"overlay"===n&&(0,l.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-30 w-48 bg-black/60 backdrop-blur-md p-2 rounded-full border border-white/10 flex flex-col gap-1 transition-opacity duration-300 opacity-0 group-hover:opacity-100",children:[(0,l.jsxs)("div",{className:"flex justify-between text-[8px] text-neutral-400 font-bold uppercase px-2",children:[(0,l.jsx)("span",{children:"Ref"}),(0,l.jsx)("span",{children:"Assignment"})]}),(0,l.jsx)("input",{type:"range",min:"0",max:"100",value:w,onChange:e=>j(Number(e.target.value)),className:"w-full h-1 bg-white/20 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:bg-[#d90238] [&::-webkit-slider-thumb]:rounded-full"})]}),"full"===n&&(0,l.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-30 bg-black/60 backdrop-blur-md p-1 rounded-full border border-white/10 flex items-center gap-2 transition-opacity duration-300 opacity-0 group-hover:opacity-100",children:[(0,l.jsx)("button",{onClick:()=>y("reference"),className:"px-3 py-1 rounded-full text-[9px] font-bold uppercase transition-all ".concat("reference"===N?"bg-white text-black":"text-neutral-400 hover:text-white"),children:"Reference"}),(0,l.jsx)("button",{onClick:()=>y("render"),className:"px-3 py-1 rounded-full text-[9px] font-bold uppercase transition-all ".concat("render"===N?"bg-[#d90238] text-white":"text-neutral-400 hover:text-white"),children:"Student"})]})]})}var v=r(8994),w=r(1460),j=r(3195),N=r(1213),y=r(5005),k=r(1049),_=r(2235),S=r(6490),z=r(8998),C=r(6578),E=r(7326),Z=r(8390),I=r(632),R=r(7805),A=r(834),O=r(9990);function T(){(0,i.useRouter)();let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{let e=localStorage.getItem("activeUserEmail");if(!e){window.location.href="/login";return}(0,a.x4)(e).then(e=>{e?t(e):window.location.href="/login",n(!1)})},[]),r)?(0,l.jsx)("div",{className:"min-h-screen bg-[#050505] flex items-center justify-center",children:(0,l.jsx)(v.Z,{className:"animate-spin text-[#d90238]",size:32})}):e?(0,l.jsx)("div",{className:"w-full h-screen bg-[#050505] text-neutral-200 font-sans selection:bg-[#d90238] selection:text-white flex overflow-hidden",children:(0,l.jsx)(U,{user:e,setUser:t})}):null}function U(e){var t,r,i,o,c,d,u;let{user:x,setUser:h}=e,[f,m]=(0,s.useState)([]),[b,p]=(0,s.useState)([]),[T,U]=(0,s.useState)("workspace"),[L,P]=(0,s.useState)("interior"),[D,F]=(0,s.useState)(null),[G,q]=(0,s.useState)(!1),[M,B]=(0,s.useState)(null),[K,V]=(0,s.useState)(""),[H,J]=(0,s.useState)(""),[Y,W]=(0,s.useState)(!1),[X,$]=(0,s.useState)({interior:null,exterior:null}),[Q,ee]=(0,s.useState)({interior:"",exterior:""}),[et,er]=(0,s.useState)(!1),el="master_class"===x.enrolled_class,es=el?"ARCHITECTURE MODELING":null;(0,s.useEffect)(()=>{(async()=>{if("workspace"===T){let e=await (0,a.Mb)(x.id);if(e){let t=e.filter(e=>e.assignment_number===x.current_level).sort((e,t)=>new Date(e.created_at||0).getTime()-new Date(t.created_at||0).getTime());m(t);let r=t.length>0?t[t.length-1]:null;r&&"rejected"!==r.status?F(r.id):F(null)}}else{let e=await (0,a.F)();e&&p(e)}})()},[x.id,x.current_level,T]);let ei=async()=>{if(confirm("Are you sure you want to reset your master references? This will reload the page.")){q(!0);try{let{error:e}=await n.O.rpc("reset_student_references",{user_id:x.id});if(e)throw e;let t={...x,references:void 0};h(t)}catch(e){console.error("Error resetting references:",e),alert("Failed to reset references.")}finally{q(!1)}}},en=(e,t)=>{var r;if(null===(r=e.target.files)||void 0===r?void 0:r[0]){let r=e.target.files[0];$(e=>({...e,[t]:r})),ee(e=>({...e,[t]:URL.createObjectURL(r)}))}},ea=e=>{$(t=>({...t,[e]:null})),ee(t=>({...t,[e]:""}))},eo=async()=>{var e,t;if((X.interior||(null===(e=x.references)||void 0===e?void 0:e.interior))&&(X.exterior||(null===(t=x.references)||void 0===t?void 0:t.exterior))){er(!0);try{await (0,a.un)(x.id,X.interior,X.exterior);let e={...x,references:{interior:Q.interior,exterior:Q.exterior}};h(e)}catch(e){console.error(e),alert("Upload failed.")}finally{er(!1)}}},ec=async()=>{var e,t;if(!M)return;W(!0);let r="interior"===L?null===(e=x.references)||void 0===e?void 0:e.interior:null===(t=x.references)||void 0===t?void 0:t.exterior;await (0,a.Kf)(x.id,x.current_level,r||"",M,H);let l=await (0,a.Mb)(x.id);l&&m(l.filter(e=>e.assignment_number===x.current_level).sort((e,t)=>new Date(e.created_at||0).getTime()-new Date(t.created_at||0).getTime())),B(null),V(""),J(""),W(!1)},ed=()=>{localStorage.removeItem("activeUserEmail"),window.location.href="/login"},eu=f.length>0?f[f.length-1]:null,ex=(null==eu?void 0:eu.status)==="pending",eh=(null==eu?void 0:eu.status)==="approved",ef=(null==eu?void 0:eu.status)==="rejected",em=!eu||ef,eb="interior"===L?null===(t=x.references)||void 0===t?void 0:t.interior:null===(r=x.references)||void 0===r?void 0:r.exterior,ep=K,eg="DRAFT";if(D){let e=f.find(e=>e.id===D);e&&(ep=e.render_image_url,eg=e.status.toUpperCase())}let ev=!(null===(i=x.references)||void 0===i?void 0:i.interior)||!(null===(o=x.references)||void 0===o?void 0:o.exterior);return(0,l.jsxs)("div",{className:"flex w-full h-screen bg-[#050505] overflow-hidden",children:[!ev&&(0,l.jsxs)("div",{className:"w-20 bg-[#0a0a0a] border-r border-white/5 flex flex-col items-center py-0 shrink-0 z-50 animate-in fade-in slide-in-from-left-4 duration-500",children:[(0,l.jsx)("div",{className:"h-20 flex items-center justify-center w-full mb-6",children:(0,l.jsx)("div",{className:"w-10 h-10 bg-[#d90238] rounded-lg flex items-center justify-center font-black text-white text-[10px] tracking-tighter leading-none shadow-[0_0_15px_rgba(217,2,56,0.3)]",children:"RTA"})}),(0,l.jsxs)("div",{className:"flex flex-col gap-6 items-center w-full",children:[(0,l.jsx)("button",{onClick:()=>U("workspace"),className:"w-10 h-10 rounded-lg flex items-center justify-center transition-all ".concat("workspace"===T?"bg-white text-black shadow-lg scale-105":"text-neutral-500 hover:bg-white/5 hover:text-white"),title:"Workspace",children:(0,l.jsx)(w.Z,{size:20})}),(0,l.jsx)("button",{onClick:()=>U("gallery"),className:"w-10 h-10 rounded-lg flex items-center justify-center transition-all ".concat("gallery"===T?"bg-white text-black shadow-lg scale-105":"text-neutral-500 hover:bg-white/5 hover:text-white"),title:"Gallery",children:(0,l.jsx)(j.Z,{size:20})})]}),(0,l.jsx)("div",{className:"flex-1"}),(0,l.jsxs)("div",{className:"flex flex-col gap-4 items-center mb-6",children:[(0,l.jsxs)("button",{className:"w-10 h-10 rounded-full border border-white/5 flex items-center justify-center text-neutral-500 hover:bg-white/5 hover:text-white transition-all",title:"Profile / History",children:[(0,l.jsx)(N.Z,{size:20})," "]}),(0,l.jsxs)("button",{onClick:ei,disabled:G,className:"w-10 h-10 rounded-full border border-white/5 flex items-center justify-center text-neutral-500 hover:bg-white/5 hover:text-white transition-all disabled:opacity-50",title:"Settings",children:[G?(0,l.jsx)(v.Z,{className:"animate-spin",size:16}):(0,l.jsx)(y.Z,{size:16})," "]}),(0,l.jsx)("button",{onClick:ed,className:"w-10 h-10 rounded-full border border-white/5 flex items-center justify-center text-neutral-500 hover:bg-[#d90238] hover:border-[#d90238] hover:text-white transition-all",title:"Logout",children:(0,l.jsx)(k.Z,{size:16})})]})]}),(0,l.jsxs)("div",{className:"flex-1 flex flex-col relative min-w-0",children:[(0,l.jsxs)("header",{className:"h-20 border-b border-white/5 bg-[#050505] flex items-center justify-between px-8 shrink-0 z-40 ".concat(ev?"px-12":""),children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[ev&&(0,l.jsx)("div",{className:"w-10 h-10 bg-[#d90238] rounded-lg flex items-center justify-center font-black text-white text-[10px] tracking-tighter leading-none shadow-[0_0_15px_rgba(217,2,56,0.3)] mr-2",children:"RTA"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-xl font-black text-white tracking-tighter leading-none",children:el?"MASTER CLASS":"VISUALIZATION CLASS"}),es&&(0,l.jsx)("p",{className:"text-[10px] text-[#d90238] font-bold uppercase tracking-[0.2em] mt-1",children:es})]})]}),ev&&(0,l.jsxs)("button",{onClick:ed,className:"flex items-center gap-2 text-neutral-500 hover:text-white transition-colors text-xs font-bold uppercase tracking-widest border border-white/10 px-4 py-2 rounded-full hover:bg-white/5",children:[(0,l.jsx)(k.Z,{size:14})," LOGOUT"]})]}),(0,l.jsx)("div",{className:"flex-1 flex overflow-hidden relative",children:ev?(0,l.jsx)("div",{className:"w-full h-full flex flex-col items-center justify-center p-6 bg-[#050505] animate-in fade-in zoom-in-95 duration-500",children:(0,l.jsxs)("div",{className:"max-w-4xl w-full text-center space-y-10",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-[#d90238] text-[10px] font-bold tracking-[0.3em] uppercase border border-[#d90238]/30 px-4 py-1.5 rounded-full bg-[#d90238]/5 shadow-[0_0_15px_rgba(217,2,56,0.1)]",children:"Project Initialization"}),(0,l.jsx)("h1",{className:"text-5xl font-black text-white mt-6 mb-2 tracking-tight",children:"Upload Master References"}),(0,l.jsx)("p",{className:"text-neutral-500 text-sm",children:"These will serve as the ground truth for all future assignments."})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-8",children:["interior","exterior"].map(e=>(0,l.jsxs)("div",{className:"group relative aspect-video bg-[#0a0a0a] border border-white/5 rounded-2xl overflow-hidden hover:border-[#d90238]/50 transition-all cursor-pointer shadow-2xl",children:[!("interior"===e?Q.interior:Q.exterior)&&(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:t=>en(t,e),className:"absolute inset-0 z-20 opacity-0 cursor-pointer"}),("interior"===e?Q.interior:Q.exterior)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("img",{src:"interior"===e?Q.interior:Q.exterior,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"}),(0,l.jsx)("button",{onClick:()=>ea(e),className:"absolute top-3 right-3 z-30 w-8 h-8 bg-black/50 backdrop-blur hover:bg-[#d90238] rounded-full flex items-center justify-center text-white transition-colors",children:(0,l.jsx)(_.Z,{size:14})})]}):(0,l.jsx)("div",{className:"absolute inset-0 flex flex-col items-center justify-center group-hover:scale-105 transition-transform duration-500",children:(0,l.jsxs)("span",{className:"text-xs font-bold uppercase tracking-[0.2em] text-neutral-500 group-hover:text-white transition-colors",children:["CLICK TO UPLOAD ",e]})})]},e))}),(0,l.jsx)("div",{className:"flex justify-center pt-4",children:(0,l.jsx)("button",{onClick:eo,disabled:et||!Q.interior||!Q.exterior,className:"bg-[#d90238] hover:bg-[#b0022d] text-white px-12 py-4 rounded-xl font-bold uppercase tracking-widest text-xs w-full max-w-md disabled:opacity-30 disabled:cursor-not-allowed shadow-[0_0_20px_rgba(217,2,56,0.2)] hover:shadow-[0_0_30px_rgba(217,2,56,0.4)]",children:et?"INITIALIZING...":"INITIALIZE PROJECT"})})]})}):"workspace"===T?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"flex-1 flex flex-col bg-[#020202] relative min-w-0 items-center justify-center p-6",children:(0,l.jsxs)("div",{className:"w-full h-full aspect-video bg-black relative border border-white/5 rounded-2xl overflow-hidden shadow-2xl",children:[eb&&ep?(0,l.jsx)(g,{referenceImage:eb,renderImage:ep,className:"w-full h-full"}):eb?(0,l.jsx)("div",{className:"w-full h-full relative group flex items-center justify-center",children:(0,l.jsx)("img",{src:eb,className:"w-full h-full object-contain opacity-50 grayscale transition-all duration-700"})}):(0,l.jsx)("div",{className:"w-full h-full flex flex-col items-center justify-center opacity-20",children:(0,l.jsx)("p",{className:"text-neutral-500 font-mono text-xs uppercase tracking-widest",children:"Select Context"})}),(0,l.jsx)("div",{className:"absolute bottom-8 left-8 z-20 pointer-events-none",children:(0,l.jsxs)("div",{className:"px-4 py-2 rounded-full border backdrop-blur-md flex items-center gap-2 ".concat("PENDING"===eg?"bg-amber-500/10 border-amber-500/30 text-amber-500":"REJECTED"===eg?"bg-[#d90238]/10 border-[#d90238]/30 text-[#d90238]":"APPROVED"===eg?"bg-emerald-500/10 border-emerald-500/30 text-emerald-500":"bg-white/5 border-white/10 text-neutral-400"),children:["PENDING"===eg&&(0,l.jsx)(S.Z,{size:14}),"REJECTED"===eg&&(0,l.jsx)(z.Z,{size:14}),"APPROVED"===eg&&(0,l.jsx)(C.Z,{size:14}),(0,l.jsxs)("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:[eg," STATE"]})]})})]})}),(0,l.jsxs)("div",{className:"w-[400px] bg-[#0a0a0a] border-l border-white/5 flex flex-col shrink-0 z-40 shadow-2xl",children:[(0,l.jsxs)("div",{className:"p-6 border-b border-white/5 bg-[#0a0a0a]",children:[(0,l.jsx)("h3",{className:"text-[10px] font-bold text-neutral-500 uppercase tracking-widest mb-4",children:"Submission Context"}),(0,l.jsxs)("div",{className:"flex bg-[#111] rounded-lg p-1 border border-white/5",children:[(0,l.jsxs)("button",{onClick:()=>P("interior"),className:"flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-[10px] font-bold uppercase tracking-widest transition-all ".concat("interior"===L?"bg-[#d90238] text-white shadow-lg":"text-neutral-500 hover:text-white"),children:[(0,l.jsx)(y.Z,{size:12})," Interior"]}),(0,l.jsxs)("button",{onClick:()=>P("exterior"),className:"flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-[10px] font-bold uppercase tracking-widest transition-all ".concat("exterior"===L?"bg-[#d90238] text-white shadow-lg":"text-neutral-500 hover:text-white"),children:[(0,l.jsx)(E.Z,{size:12})," Exterior"]})]})]}),(0,l.jsxs)("div",{className:"p-6 border-b border-white/5",children:[(0,l.jsxs)("h3",{className:"text-[10px] font-bold text-neutral-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[(0,l.jsx)(Z.Z,{size:12})," Timeline"]}),(0,l.jsxs)("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:[f.map((e,t)=>(0,l.jsx)("button",{onClick:()=>F(e.id),className:"flex flex-col items-center gap-2 group min-w-[60px] cursor-pointer transition-opacity ".concat(D&&D!==e.id?"opacity-50 hover:opacity-100":"opacity-100"),children:(0,l.jsxs)("div",{className:"w-10 h-10 rounded-full border flex items-center justify-center text-[10px] font-bold transition-all ".concat(D===e.id?"bg-white text-black scale-110 shadow-[0_0_15px_rgba(255,255,255,0.3)]":"rejected"===e.status?"border-[#d90238] text-[#d90238] bg-[#d90238]/10":"approved"===e.status?"border-emerald-500 text-emerald-500 bg-emerald-500/10":"border-amber-500 text-amber-500 bg-amber-500/10"),children:["v",t+1]})},e.id)),em&&(0,l.jsx)("button",{onClick:()=>F(null),className:"flex flex-col items-center gap-2 group min-w-[60px] cursor-pointer transition-opacity ".concat(null!==D?"opacity-50 hover:opacity-100":"opacity-100"),children:(0,l.jsx)("div",{className:"w-10 h-10 rounded-full border border-dashed border-neutral-700 flex items-center justify-center text-neutral-500 transition-all ".concat(null===D?"border-[#d90238] text-[#d90238] bg-[#d90238]/10":"hover:border-neutral-500 hover:text-white"),children:(0,l.jsx)(I.Z,{size:14})})})]})]}),(0,l.jsx)("div",{className:"flex-1 p-6 flex flex-col overflow-y-auto bg-[#0a0a0a]",children:D?(0,l.jsxs)("div",{className:"space-y-6 animate-in slide-in-from-right-4",children:[(null===(c=f.find(e=>e.id===D))||void 0===c?void 0:c.teacher_comment)&&(0,l.jsxs)("div",{className:"bg-[#d90238]/10 border border-[#d90238]/20 p-4 rounded-xl",children:[(0,l.jsxs)("h4",{className:"text-[#d90238] text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[(0,l.jsx)(z.Z,{size:14})," Instructor Feedback"]}),(0,l.jsxs)("p",{className:"text-neutral-300 text-sm leading-relaxed font-medium",children:['"',null===(d=f.find(e=>e.id===D))||void 0===d?void 0:d.teacher_comment,'"']})]}),(0,l.jsxs)("div",{className:"bg-white/5 border border-white/5 p-4 rounded-xl",children:[(0,l.jsx)("h4",{className:"text-neutral-500 text-[10px] font-bold uppercase mb-2",children:"Student Note"}),(0,l.jsxs)("p",{className:"text-neutral-400 text-sm italic",children:['"',(null===(u=f.find(e=>e.id===D))||void 0===u?void 0:u.student_message)||"No notes added.",'"']})]}),ef&&D===(null==eu?void 0:eu.id)&&(0,l.jsxs)("button",{onClick:()=>F(null),className:"w-full py-4 bg-[#d90238] hover:bg-[#b0022d] text-white font-bold uppercase tracking-widest text-xs rounded-xl transition-all flex items-center justify-center gap-2 shadow-lg shadow-red-900/20",children:["Start Revision (v",f.length+1,") ",(0,l.jsx)(R.Z,{size:14})]})]}):!em&&ex?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-6 border border-amber-500/20 bg-amber-500/5 rounded-xl",children:[(0,l.jsx)(S.Z,{size:32,className:"text-amber-500 mb-4 animate-pulse"}),(0,l.jsx)("h3",{className:"text-white font-bold text-lg",children:"Under Review"}),(0,l.jsx)("p",{className:"text-neutral-500 text-sm mt-2 leading-relaxed",children:"Your instructor is reviewing your submission."})]}):!em&&eh?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-6 border border-emerald-500/20 bg-emerald-500/5 rounded-xl",children:[(0,l.jsx)(C.Z,{size:32,className:"text-emerald-500 mb-4"}),(0,l.jsx)("h3",{className:"text-white font-bold text-lg",children:"Approved"}),(0,l.jsx)("p",{className:"text-neutral-500 text-sm mt-2 leading-relaxed",children:"You have passed this protocol."})]}):(0,l.jsxs)("div",{className:"flex flex-col h-full animate-in slide-in-from-right-4",children:[(0,l.jsx)("h3",{className:"text-white text-lg font-bold mb-1",children:"Submit Render"}),(0,l.jsxs)("p",{className:"text-neutral-500 text-xs mb-6",children:["Upload your ",L," render for review."]}),(0,l.jsxs)("label",{className:"flex-1 min-h-[150px] border-2 border-dashed rounded-xl flex flex-col items-center justify-center cursor-pointer transition-all mb-6 relative group ".concat(K?"border-[#d90238] bg-[#d90238]/5":"border-white/10 hover:border-[#d90238]/50 hover:bg-white/5"),children:[(0,l.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;(null===(t=e.target.files)||void 0===t?void 0:t[0])&&(B(e.target.files[0]),V(URL.createObjectURL(e.target.files[0])))}}),K?(0,l.jsxs)("div",{className:"relative w-full h-full p-2",children:[(0,l.jsx)("img",{src:K,className:"w-full h-full object-contain rounded-lg"}),(0,l.jsx)("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-lg backdrop-blur-sm",children:(0,l.jsxs)("span",{className:"text-white text-xs font-bold uppercase flex items-center gap-2",children:[(0,l.jsx)(A.Z,{size:14})," Change Image"]})})]}):(0,l.jsxs)("div",{className:"flex flex-col items-center text-neutral-500 group-hover:text-white transition-colors",children:[(0,l.jsx)("div",{className:"w-12 h-12 rounded-full bg-white/5 flex items-center justify-center mb-3 group-hover:bg-[#d90238] transition-colors",children:(0,l.jsx)(I.Z,{size:20})}),(0,l.jsx)("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Click to Upload"})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("textarea",{value:H,onChange:e=>J(e.target.value),placeholder:"Notes...",className:"w-full bg-black border border-white/10 rounded-xl p-4 text-sm text-white focus:border-[#d90238] focus:outline-none resize-none h-20 placeholder:text-neutral-700"}),(0,l.jsx)("button",{onClick:ec,disabled:!K||Y,className:"w-full py-4 bg-[#d90238] hover:bg-[#b0022d] disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold uppercase tracking-widest text-xs rounded-xl transition-all flex items-center justify-center gap-2 shadow-[0_0_20px_rgba(217,2,56,0.3)] hover:shadow-[0_0_30px_rgba(217,2,56,0.5)]",children:Y?(0,l.jsx)(v.Z,{className:"animate-spin",size:16}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(O.Z,{size:14})," Submit"]})})]})]})})]})]}):(0,l.jsxs)("div",{className:"flex-1 bg-[#020202] p-8 overflow-y-auto animate-in fade-in",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-black text-white tracking-tight",children:"Academy Gallery"}),(0,l.jsx)("p",{className:"text-neutral-500 text-sm mt-2",children:"Explore approved submissions from fellow students."})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6",children:b.map(e=>(0,l.jsxs)("div",{className:"aspect-square bg-[#0a0a0a] border border-white/5 rounded-xl overflow-hidden relative group cursor-pointer hover:border-[#d90238]/50 transition-all",children:[(0,l.jsx)("img",{src:e.render_image_url,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-500"}),(0,l.jsxs)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity p-4 flex flex-col justify-end",children:[(0,l.jsxs)("p",{className:"text-white font-bold text-sm",children:["Assignment ",String(e.assignment_number).padStart(2,"0")]}),(0,l.jsx)("p",{className:"text-[10px] text-[#d90238] font-mono uppercase tracking-widest",children:"Approved Work"})]})]},e.id))})]})})]})]})}},1708:function(e,t,r){"use strict";r.d(t,{F:function(){return x},Gm:function(){return c},Kf:function(){return u},Mb:function(){return d},uH:function(){return o},un:function(){return a},x4:function(){return n}});var l=r(7014);let s=e=>new Promise((t,r)=>{let l=new FileReader;l.readAsDataURL(e),l.onload=()=>t(l.result),l.onerror=e=>r(e)}),i=e=>({...e,references:e.ref_interior_url&&e.ref_exterior_url?{interior:e.ref_interior_url,exterior:e.ref_exterior_url}:void 0}),n=async e=>{let{data:t,error:r}=await l.O.from("profiles").select("*").eq("email",e).single();return r||!t?null:i(t)},a=async(e,t,r)=>{try{let n={};if(t){let e=await s(t);n.ref_interior_url=e}if(r){let e=await s(r);n.ref_exterior_url=e}let{data:a,error:o}=await l.O.from("profiles").update(n).eq("id",e).select().single();if(o)return console.error("Upload Error:",o.message),null;return i(a)}catch(e){return console.error("Unexpected Error:",e),null}},o=async()=>{let{data:e}=await l.O.from("profiles").select("*").eq("role","student");return(null==e?void 0:e.map(i))||[]},c=async()=>{let{data:e}=await l.O.from("submissions").select("*");return e||[]},d=async e=>{let{data:t}=await l.O.from("submissions").select("*").eq("student_id",e);return t||[]},u=async(e,t,r,i,n)=>{let a=i?await s(i):"https://via.placeholder.com/800",{error:o}=await l.O.from("submissions").insert({student_id:e,assignment_number:t,reference_image_url:r,render_image_url:a,status:"pending",student_message:n,created_at:new Date().toISOString()});return o&&console.error("Submit Error:",o.message),!o},x=async()=>{let{data:e}=await l.O.from("submissions").select("*").eq("status","approved");return e||[]}},7014:function(e,t,r){"use strict";r.d(t,{O:function(){return a}});var l=r(7688),s=r(9079);let i=s.env.NEXT_PUBLIC_SUPABASE_URL,n=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,a=(0,l.eI)(i,n)}},function(e){e.O(0,[530,806,971,69,744],function(){return e(e.s=2456)}),_N_E=e.O()}]);