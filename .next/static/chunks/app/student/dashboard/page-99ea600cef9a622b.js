(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{2456:function(e,t,r){Promise.resolve().then(r.bind(r,4125))},4125:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var s=r(3827),l=r(4090),i=r(7907),a=r(7014),n=r(1708),o=r(2437),c=r(4220),d=r(6548),x=r(7898),u=r(9783),h=r(1828),m=r(4325),f=r(4067),p=r(5751),b=r(3348);let g=[{id:"slide",label:"Slide",icon:o.Z},{id:"split",label:"Split H",icon:c.Z},{id:"split-vertical",label:"Split V",icon:d.Z},{id:"overlay",label:"Blend",icon:x.Z},{id:"full",label:"Full View",icon:u.Z}],v=e=>{let{referenceImage:t,renderImage:r,className:i="",isModalView:a=!1}=e,[n,c]=(0,l.useState)("slide"),[d,x]=(0,l.useState)(50),[w,j]=(0,l.useState)(50),[N,y]=(0,l.useState)("render"),[k,_]=(0,l.useState)(g),[E,S]=(0,l.useState)(null),[R,z]=(0,l.useState)(1),[C,Z]=(0,l.useState)({x:0,y:0}),[D,L]=(0,l.useState)(!1),[I,A]=(0,l.useState)({x:0,y:0}),[U,O]=(0,l.useState)(!1),T=(0,l.useRef)(null),F=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=F.current;if(!e)return;let t=e=>{e.preventDefault();let t=e.deltaY>0?-1:1;z(e=>{let r=Math.min(Math.max(1,e+.1*t),8);return 1===r&&Z({x:0,y:0}),r})};return e.addEventListener("wheel",t,{passive:!1}),()=>e.removeEventListener("wheel",t)},[]);let M=()=>{L(!1)},P=()=>{z(1),Z({x:0,y:0})},V=(0,l.useCallback)(e=>{if(!F.current)return;let t=F.current.getBoundingClientRect();x(Math.max(0,Math.min(Math.max(0,Math.min(e-t.left,t.width))/t.width*100,100)))},[]),[G,B]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=e=>{G&&(e.preventDefault(),V(e.clientX))},t=()=>B(!1);return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[G,V]);let q=e=>{S(e)},X=(e,t)=>{if(e.preventDefault(),null===E||E===t)return;let r=[...k],s=r[E];r.splice(E,1),r.splice(t,0,s),S(t),_(r)},Y=()=>{S(null)},H={transform:"translate(".concat(C.x,"px, ").concat(C.y,"px) scale(").concat(R,")"),transition:D?"none":"transform 0.1s cubic-bezier(0.2, 0.8, 0.2, 1)",cursor:R>1?D?"grabbing":"grab":"default",transformOrigin:"center center",willChange:"transform"},K="absolute inset-0 w-full h-full object-contain pointer-events-none select-none",J={onMouseDown:e=>{R>1&&(L(!0),A({x:e.clientX-C.x,y:e.clientY-C.y}))},onMouseMove:e=>{D&&R>1&&(e.preventDefault(),Z({x:e.clientX-I.x,y:e.clientY-I.y}))},onMouseUp:M,onMouseLeave:M};return U&&!a?(0,s.jsxs)("div",{className:"fixed inset-0 z-[200] bg-[#050505] animate-in fade-in duration-200 flex flex-col",children:[(0,s.jsxs)("div",{className:"h-14 border-b border-white/10 bg-[#0a0a0a] flex items-center justify-between px-6 shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.Z,{className:"text-primary",size:18}),(0,s.jsx)("span",{className:"text-white font-bold tracking-wider text-sm",children:"FULLSCREEN MODE"})]}),(0,s.jsxs)("button",{onClick:()=>O(!1),className:"flex items-center gap-2 bg-neutral-800 hover:bg-neutral-700 text-white px-4 py-2 rounded-sm text-xs font-bold border border-white/5 transition-colors shadow-lg",children:[(0,s.jsx)(m.Z,{size:14})," EXIT"]})]}),(0,s.jsx)("div",{className:"flex-1 relative",children:(0,s.jsx)(v,{referenceImage:t,renderImage:r,isModalView:!0,className:"h-full border-0 rounded-none w-full"})})]}):(0,s.jsxs)("div",{ref:T,className:"flex flex-col bg-[#0a0a0a] border border-dark-border rounded-lg overflow-hidden select-none shadow-2xl ".concat(i," group"),children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between px-4 py-2 border-b border-white/5 bg-[#0f0f0f] min-h-12 shrink-0 backdrop-blur-xl gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar",children:[(0,s.jsx)("span",{className:"text-[10px] text-neutral-600 mr-2 uppercase tracking-widest hidden sm:block",children:"View:"}),k.map((e,t)=>(0,s.jsx)("div",{draggable:!0,onDragStart:()=>q(t),onDragOver:e=>X(e,t),onDrop:Y,className:"transition-transform duration-200 ".concat(E===t?"opacity-50 scale-95":""),children:(0,s.jsxs)("button",{onClick:()=>{c(e.id),P()},className:"group relative p-1.5 px-3 rounded-sm flex items-center gap-2 text-[10px] font-bold uppercase transition-all whitespace-nowrap cursor-pointer ".concat(n===e.id?"bg-primary text-white shadow-glow":"text-neutral-500 hover:text-white hover:bg-white/5"),children:[(0,s.jsx)(f.Z,{size:8,className:"text-neutral-700 group-hover:text-neutral-500 cursor-grab"}),(0,s.jsx)(e.icon,{size:14}),(0,s.jsx)("span",{className:"hidden sm:inline",children:e.label})]})},e.id))]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 ml-auto",children:[(0,s.jsxs)("div",{className:"hidden sm:flex items-center gap-2 text-neutral-500 text-[10px] font-mono border-r border-white/10 pr-3 mr-1",children:[(0,s.jsx)(p.Z,{size:12}),(0,s.jsxs)("span",{children:[Math.round(100*R),"%"]})]}),(0,s.jsx)("button",{onClick:P,className:"text-neutral-500 hover:text-white p-1.5 hover:bg-white/5 rounded transition-colors",title:"Reset View",children:(0,s.jsx)(b.Z,{size:14})}),!a&&(0,s.jsx)("button",{onClick:()=>O(!0),className:"flex items-center gap-2 text-xs font-bold text-neutral-400 hover:text-primary transition-colors ml-2",title:"Fullscreen",children:(0,s.jsx)(u.Z,{size:14})})]})]}),(0,s.jsx)("div",{ref:F,className:"flex-1 overflow-hidden relative min-h-0 bg-[#020202] cursor-crosshair touch-none",style:{overscrollBehavior:"none"},children:(()=>{switch(n){case"slide":return(0,s.jsxs)("div",{className:"relative w-full h-full overflow-hidden bg-[#050505]",...J,children:[(0,s.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center overflow-hidden",children:[(0,s.jsx)("div",{style:H,className:"w-full h-full relative flex items-center justify-center",children:(0,s.jsx)("img",{src:r,className:K,alt:"Render"})}),(0,s.jsx)("div",{className:"absolute top-4 right-4 bg-black/60 backdrop-blur-sm border border-white/10 text-white text-[10px] px-3 py-1 font-bold rounded-full pointer-events-none z-10 shadow-lg",children:"RENDER"})]}),(0,s.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center overflow-hidden border-r-2 border-primary shadow-[0_0_20px_rgba(0,0,0,0.5)]",style:{clipPath:"inset(0 ".concat(100-d,"% 0 0)")},children:[(0,s.jsx)("div",{style:H,className:"w-full h-full relative flex items-center justify-center",children:(0,s.jsx)("img",{src:t,className:K,alt:"Reference"})}),(0,s.jsx)("div",{className:"absolute top-4 left-4 bg-primary/90 backdrop-blur-sm text-white text-[10px] px-3 py-1 font-bold rounded-full pointer-events-none z-10 shadow-lg",children:"REFERENCE"})]}),(0,s.jsxs)("div",{className:"absolute inset-y-0 w-10 -ml-5 z-30 cursor-ew-resize flex items-center justify-center group outline-none",style:{left:"".concat(d,"%")},onMouseDown:()=>B(!0),children:[(0,s.jsx)("div",{className:"w-0.5 h-full bg-primary shadow-[0_0_15px_rgba(222,4,67,1)] transition-all group-hover:w-1 group-hover:bg-white"}),(0,s.jsx)("div",{className:"absolute w-8 h-8 bg-black border-2 border-primary rounded-full flex items-center justify-center text-white shadow-xl scale-75 group-hover:scale-110 transition-transform",children:(0,s.jsx)(o.Z,{size:14})})]})]});case"split":return(0,s.jsxs)("div",{className:"w-full h-full grid grid-cols-2 divide-x divide-white/10 bg-[#050505]",...J,children:[(0,s.jsxs)("div",{className:"relative overflow-hidden w-full h-full bg-black/20 group/split",children:[(0,s.jsx)("div",{style:H,className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)("img",{src:t,className:K,alt:"Reference"})}),(0,s.jsx)("div",{className:"absolute top-4 left-4 bg-black/60 backdrop-blur-sm border border-white/10 text-white text-[10px] px-3 py-1 font-bold rounded-full pointer-events-none",children:"REF"})]}),(0,s.jsxs)("div",{className:"relative overflow-hidden w-full h-full bg-black/20 group/split",children:[(0,s.jsx)("div",{style:H,className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)("img",{src:r,className:K,alt:"Render"})}),(0,s.jsx)("div",{className:"absolute top-4 right-4 bg-primary/80 backdrop-blur-sm text-white text-[10px] px-3 py-1 font-bold rounded-full pointer-events-none",children:"RENDER"})]})]});case"split-vertical":return(0,s.jsxs)("div",{className:"w-full h-full grid grid-rows-2 divide-y divide-white/10 bg-[#050505]",...J,children:[(0,s.jsxs)("div",{className:"relative overflow-hidden w-full h-full bg-black/20 group/split",children:[(0,s.jsx)("div",{style:H,className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)("img",{src:t,className:K,alt:"Reference"})}),(0,s.jsx)("div",{className:"absolute top-4 left-4 bg-black/60 backdrop-blur-sm border border-white/10 text-white text-[10px] px-3 py-1 font-bold rounded-full pointer-events-none",children:"REF"})]}),(0,s.jsxs)("div",{className:"relative overflow-hidden w-full h-full bg-black/20 group/split",children:[(0,s.jsx)("div",{style:H,className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)("img",{src:r,className:K,alt:"Render"})}),(0,s.jsx)("div",{className:"absolute top-4 right-4 bg-primary/80 backdrop-blur-sm text-white text-[10px] px-3 py-1 font-bold rounded-full pointer-events-none",children:"RENDER"})]})]});case"overlay":return(0,s.jsxs)("div",{className:"relative w-full h-full overflow-hidden bg-[#050505]",...J,children:[(0,s.jsxs)("div",{style:H,className:"w-full h-full relative flex items-center justify-center",children:[(0,s.jsx)("img",{src:t,className:K,alt:"Reference"}),(0,s.jsx)("img",{src:r,className:K,style:{opacity:w/100},alt:"Render"})]}),(0,s.jsxs)("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 bg-black/80 backdrop-blur-md border border-white/10 px-6 py-3 rounded-full flex items-center gap-4 shadow-2xl",children:[(0,s.jsx)("span",{className:"text-[10px] font-bold text-neutral-400",children:"REF"}),(0,s.jsx)("input",{type:"range",min:"0",max:"100",value:w,onChange:e=>j(Number(e.target.value)),className:"w-32 h-1 accent-primary bg-neutral-700 rounded-lg appearance-none cursor-pointer"}),(0,s.jsx)("span",{className:"text-[10px] font-bold text-primary",children:"RENDER"})]})]});case"full":return(0,s.jsxs)("div",{className:"relative w-full h-full overflow-hidden bg-[#050505]",...J,children:[(0,s.jsx)("div",{style:H,className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)("img",{src:"ref"===N?t:r,className:K,alt:"Full View"})}),(0,s.jsxs)("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex items-center bg-black/80 backdrop-blur-md border border-white/10 rounded-full p-1 shadow-2xl",children:[(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),y("ref")},className:"px-4 py-2 rounded-full text-[10px] font-bold uppercase transition-all ".concat("ref"===N?"bg-white text-black shadow-glow":"text-neutral-500 hover:text-white"),children:"Reference"}),(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),y("render")},className:"px-4 py-2 rounded-full text-[10px] font-bold uppercase transition-all ".concat("render"===N?"bg-primary text-white shadow-glow":"text-neutral-500 hover:text-white"),children:"Render"})]}),(0,s.jsx)("div",{className:"absolute top-4 right-4 text-white text-[10px] px-3 py-1 font-bold rounded-full pointer-events-none backdrop-blur-sm shadow-lg ".concat("ref"===N?"bg-neutral-800/80 border border-white/10":"bg-primary/80"),children:"ref"===N?"FULL REFERENCE":"FULL RENDER"})]})}})()})]})};var w=r(8994),j=r(1460),N=r(3195),y=r(1213),k=r(5005),_=r(1049),E=r(2235),S=r(6490),R=r(8998),z=r(6578),C=r(7326),Z=r(8390),D=r(632),L=r(7805),I=r(834),A=r(9990),U=r(684),O=r(7624),T=r(7307);function F(){(0,i.useRouter)();let[e,t]=(0,l.useState)(null),[r,a]=(0,l.useState)(!0);return((0,l.useEffect)(()=>{let e=localStorage.getItem("activeUserEmail");if(!e){window.location.href="/login";return}(0,n.x4)(e).then(e=>{e?t(e):window.location.href="/login",a(!1)})},[]),r)?(0,s.jsx)("div",{className:"min-h-screen bg-[#050505] flex items-center justify-center",children:(0,s.jsx)(w.Z,{className:"animate-spin text-[#d90238]",size:32})}):e?(0,s.jsx)("div",{className:"w-full h-screen bg-[#050505] text-neutral-200 font-sans selection:bg-[#d90238] selection:text-white flex overflow-hidden",children:(0,s.jsx)(M,{user:e,setUser:t})}):null}function M(e){var t,r,i,o,c,d,x,u;let{user:h,setUser:m}=e,[f,p]=(0,l.useState)([]),[b,g]=(0,l.useState)([]),[F,M]=(0,l.useState)("workspace"),[P,V]=(0,l.useState)("interior"),[G,B]=(0,l.useState)(null),[q,X]=(0,l.useState)(!1),[Y,H]=(0,l.useState)(null),[K,J]=(0,l.useState)(""),[W,Q]=(0,l.useState)(""),[$,ee]=(0,l.useState)(!1),[et,er]=(0,l.useState)({interior:null,exterior:null}),[es,el]=(0,l.useState)({interior:"",exterior:""}),[ei,ea]=(0,l.useState)(!1),en="master_class"===h.enrolled_class,eo=en?"ARCHITECTURE MODELING":null;(0,l.useEffect)(()=>{(async()=>{let e=await (0,n.Mb)(h.id);if(e&&(p(e.sort((e,t)=>new Date(e.created_at||0).getTime()-new Date(t.created_at||0).getTime())),"workspace"===F)){let t=e.filter(e=>e.assignment_number===h.current_level),r=t.length>0?t[t.length-1]:null;r&&"rejected"!==r.status?B(r.id):B(null)}if("gallery"===F){let e=await (0,n.F)();e&&g(e)}})()},[h.id,h.current_level,F]);let ec=async()=>{if(confirm("Are you sure you want to reset your master references? This will reload the page.")){X(!0);try{let{error:e}=await a.O.rpc("reset_student_references",{user_id:h.id});if(e)throw e;let t={...h,references:void 0};m(t),M("workspace"),el({interior:"",exterior:""})}catch(e){console.error("Error resetting references:",e),alert("Failed to reset references.")}finally{X(!1)}}},ed=(e,t)=>{var r;if(null===(r=e.target.files)||void 0===r?void 0:r[0]){let r=e.target.files[0];er(e=>({...e,[t]:r})),el(e=>({...e,[t]:URL.createObjectURL(r)}))}},ex=e=>{er(t=>({...t,[e]:null})),el(t=>({...t,[e]:""}))},eu=async()=>{var e,t;if((et.interior||(null===(e=h.references)||void 0===e?void 0:e.interior))&&(et.exterior||(null===(t=h.references)||void 0===t?void 0:t.exterior))){ea(!0);try{await (0,n.un)(h.id,et.interior,et.exterior);let e={...h,references:{interior:es.interior,exterior:es.exterior}};m(e)}catch(e){console.error(e),alert("Upload failed.")}finally{ea(!1)}}},eh=async()=>{var e,t;if(!Y)return;ee(!0);let r="interior"===P?null===(e=h.references)||void 0===e?void 0:e.interior:null===(t=h.references)||void 0===t?void 0:t.exterior;await (0,n.Kf)(h.id,h.current_level,r||"",Y,W);let s=await (0,n.Mb)(h.id);s&&p(s.sort((e,t)=>new Date(e.created_at||0).getTime()-new Date(t.created_at||0).getTime())),H(null),J(""),Q(""),ee(!1)},em=()=>{localStorage.removeItem("activeUserEmail"),window.location.href="/login"},ef=f.filter(e=>e.assignment_number===h.current_level),ep=ef.length>0?ef[ef.length-1]:null,eb=(null==ep?void 0:ep.status)==="pending",eg=(null==ep?void 0:ep.status)==="approved",ev=(null==ep?void 0:ep.status)==="rejected",ew=!ep||ev,ej="interior"===P?null===(t=h.references)||void 0===t?void 0:t.interior:null===(r=h.references)||void 0===r?void 0:r.exterior,eN=K,ey="DRAFT";if(G){let e=f.find(e=>e.id===G);e&&(eN=e.render_image_url,ey=e.status.toUpperCase())}let ek=!(null===(i=h.references)||void 0===i?void 0:i.interior)||!(null===(o=h.references)||void 0===o?void 0:o.exterior);return(0,s.jsxs)("div",{className:"flex w-full h-screen bg-[#050505] overflow-hidden",children:[!ek&&(0,s.jsxs)("div",{className:"w-20 bg-[#0a0a0a] border-r border-white/5 flex flex-col items-center py-0 shrink-0 z-50 animate-in fade-in slide-in-from-left-4 duration-500",children:[(0,s.jsx)("div",{className:"h-20 flex items-center justify-center w-full mb-6",children:(0,s.jsx)("div",{className:"w-10 h-10 bg-[#d90238] rounded-lg flex items-center justify-center font-black text-white text-[10px] tracking-tighter leading-none shadow-[0_0_15px_rgba(217,2,56,0.3)]",children:"RTA"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-6 items-center w-full",children:[(0,s.jsx)("button",{onClick:()=>M("workspace"),className:"w-10 h-10 rounded-lg flex items-center justify-center transition-all ".concat("workspace"===F?"bg-white text-black shadow-lg scale-105":"text-neutral-500 hover:bg-white/5 hover:text-white"),title:"Workspace",children:(0,s.jsx)(j.Z,{size:20})}),(0,s.jsx)("button",{onClick:()=>M("gallery"),className:"w-10 h-10 rounded-lg flex items-center justify-center transition-all ".concat("gallery"===F?"bg-white text-black shadow-lg scale-105":"text-neutral-500 hover:bg-white/5 hover:text-white"),title:"Gallery",children:(0,s.jsx)(N.Z,{size:20})})]}),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsxs)("div",{className:"flex flex-col gap-4 items-center mb-6",children:[(0,s.jsxs)("button",{onClick:()=>M("profile"),className:"w-10 h-10 rounded-full border border-white/5 flex items-center justify-center transition-all ".concat("profile"===F?"bg-white text-black shadow-lg scale-105":"text-neutral-500 hover:bg-white/5 hover:text-white"),title:"Profile / History",children:[(0,s.jsx)(y.Z,{size:20})," "]}),(0,s.jsxs)("button",{onClick:ec,disabled:q,className:"w-10 h-10 rounded-full border border-white/5 flex items-center justify-center text-neutral-500 hover:bg-white/5 hover:text-white transition-all disabled:opacity-50",title:"Settings",children:[q?(0,s.jsx)(w.Z,{className:"animate-spin",size:16}):(0,s.jsx)(k.Z,{size:16})," "]}),(0,s.jsx)("button",{onClick:em,className:"w-10 h-10 rounded-full border border-white/5 flex items-center justify-center text-neutral-500 hover:bg-[#d90238] hover:border-[#d90238] hover:text-white transition-all",title:"Logout",children:(0,s.jsx)(_.Z,{size:16})})]})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col relative min-w-0",children:[(0,s.jsxs)("header",{className:"h-20 border-b border-white/5 bg-[#050505] flex items-center justify-between px-8 shrink-0 z-40 ".concat(ek?"px-12":""," animate-in fade-in slide-in-from-top-4 duration-500"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[ek&&(0,s.jsx)("div",{className:"w-10 h-10 bg-[#d90238] rounded-lg flex items-center justify-center font-black text-white text-[10px] tracking-tighter leading-none shadow-[0_0_15px_rgba(217,2,56,0.3)] mr-2",children:"RTA"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-black text-white tracking-tighter leading-none",children:en?"MASTER CLASS":"VISUALIZATION CLASS"}),eo&&(0,s.jsx)("p",{className:"text-[10px] text-[#d90238] font-bold uppercase tracking-[0.2em] mt-1",children:eo})]})]}),ek&&(0,s.jsxs)("button",{onClick:em,className:"flex items-center gap-2 text-neutral-500 hover:text-white transition-colors text-xs font-bold uppercase tracking-widest border border-white/10 px-4 py-2 rounded-full hover:bg-white/5",children:[(0,s.jsx)(_.Z,{size:14})," LOGOUT"]})]}),(0,s.jsx)("div",{className:"flex-1 flex overflow-hidden relative",children:ek?(0,s.jsx)("div",{className:"w-full h-full flex flex-col items-center justify-center p-6 bg-[#050505] animate-in fade-in zoom-in-95 duration-500",children:(0,s.jsxs)("div",{className:"max-w-4xl w-full text-center space-y-10",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[#d90238] text-[10px] font-bold tracking-[0.3em] uppercase border border-[#d90238]/30 px-4 py-1.5 rounded-full bg-[#d90238]/5 shadow-[0_0_15px_rgba(217,2,56,0.1)]",children:"Project Initialization"}),(0,s.jsx)("h1",{className:"text-5xl font-black text-white mt-6 mb-2 tracking-tight",children:"Upload Master References"}),(0,s.jsx)("p",{className:"text-neutral-500 text-sm",children:"These will serve as the ground truth for all future assignments."})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-8",children:["interior","exterior"].map(e=>(0,s.jsxs)("div",{className:"group relative aspect-video bg-[#0a0a0a] border border-white/5 rounded-2xl overflow-hidden hover:border-[#d90238]/50 transition-all cursor-pointer shadow-2xl",children:[!("interior"===e?es.interior:es.exterior)&&(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:t=>ed(t,e),className:"absolute inset-0 z-20 opacity-0 cursor-pointer"}),("interior"===e?es.interior:es.exterior)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:"interior"===e?es.interior:es.exterior,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"}),(0,s.jsx)("button",{onClick:()=>ex(e),className:"absolute top-3 right-3 z-30 w-8 h-8 bg-black/50 backdrop-blur hover:bg-[#d90238] rounded-full flex items-center justify-center text-white transition-colors",children:(0,s.jsx)(E.Z,{size:14})})]}):(0,s.jsx)("div",{className:"absolute inset-0 flex flex-col items-center justify-center group-hover:scale-105 transition-transform duration-500",children:(0,s.jsxs)("span",{className:"text-xs font-bold uppercase tracking-[0.2em] text-neutral-500 group-hover:text-white transition-colors",children:["CLICK TO UPLOAD ",e]})})]},e))}),(0,s.jsx)("div",{className:"flex justify-center pt-4",children:(0,s.jsx)("button",{onClick:eu,disabled:ei||!es.interior||!es.exterior,className:"bg-[#d90238] hover:bg-[#b0022d] text-white px-12 py-4 rounded-xl font-bold uppercase tracking-widest text-xs w-full max-w-md disabled:opacity-30 disabled:cursor-not-allowed shadow-[0_0_20px_rgba(217,2,56,0.2)] hover:shadow-[0_0_30px_rgba(217,2,56,0.4)]",children:ei?"INITIALIZING...":"INITIALIZE PROJECT"})})]})}):(0,s.jsxs)(s.Fragment,{children:["workspace"===F&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex-1 flex flex-col bg-[#020202] relative min-w-0 items-center justify-center p-6 animate-in fade-in",children:(0,s.jsxs)("div",{className:"w-full h-full aspect-video bg-black relative border border-white/5 rounded-2xl overflow-hidden shadow-2xl",children:[ej&&eN?(0,s.jsx)(v,{referenceImage:ej,renderImage:eN,className:"w-full h-full"}):ej?(0,s.jsx)("div",{className:"w-full h-full relative group flex items-center justify-center",children:(0,s.jsx)("img",{src:ej,className:"w-full h-full object-contain opacity-50 grayscale transition-all duration-700"})}):(0,s.jsx)("div",{className:"w-full h-full flex flex-col items-center justify-center opacity-20",children:(0,s.jsx)("p",{className:"text-neutral-500 font-mono text-xs uppercase tracking-widest",children:"Select Context"})}),(0,s.jsx)("div",{className:"absolute bottom-8 left-8 z-20 pointer-events-none",children:(0,s.jsxs)("div",{className:"px-4 py-2 rounded-full border backdrop-blur-md flex items-center gap-2 ".concat("PENDING"===ey?"bg-amber-500/10 border-amber-500/30 text-amber-500":"REJECTED"===ey?"bg-[#d90238]/10 border-[#d90238]/30 text-[#d90238]":"APPROVED"===ey?"bg-emerald-500/10 border-emerald-500/30 text-emerald-500":"bg-white/5 border-white/10 text-neutral-400"),children:["PENDING"===ey&&(0,s.jsx)(S.Z,{size:14}),"REJECTED"===ey&&(0,s.jsx)(R.Z,{size:14}),"APPROVED"===ey&&(0,s.jsx)(z.Z,{size:14}),(0,s.jsxs)("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:[ey," STATE"]})]})})]})}),(0,s.jsxs)("div",{className:"w-[400px] bg-[#0a0a0a] border-l border-white/5 flex flex-col shrink-0 z-40 shadow-2xl animate-in slide-in-from-right-4",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-white/5 bg-[#0a0a0a]",children:[(0,s.jsx)("h3",{className:"text-[10px] font-bold text-neutral-500 uppercase tracking-widest mb-4",children:"Submission Context"}),(0,s.jsxs)("div",{className:"flex bg-[#111] rounded-lg p-1 border border-white/5",children:[(0,s.jsxs)("button",{onClick:()=>V("interior"),className:"flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-[10px] font-bold uppercase tracking-widest transition-all ".concat("interior"===P?"bg-[#d90238] text-white shadow-lg":"text-neutral-500 hover:text-white"),children:[(0,s.jsx)(k.Z,{size:12})," Interior"]}),(0,s.jsxs)("button",{onClick:()=>V("exterior"),className:"flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-[10px] font-bold uppercase tracking-widest transition-all ".concat("exterior"===P?"bg-[#d90238] text-white shadow-lg":"text-neutral-500 hover:text-white"),children:[(0,s.jsx)(C.Z,{size:12})," Exterior"]})]})]}),(0,s.jsxs)("div",{className:"p-6 border-b border-white/5",children:[(0,s.jsxs)("h3",{className:"text-[10px] font-bold text-neutral-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[(0,s.jsx)(Z.Z,{size:12})," Timeline"]}),(0,s.jsxs)("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:[ef.map((e,t)=>(0,s.jsx)("button",{onClick:()=>B(e.id),className:"flex flex-col items-center gap-2 group min-w-[60px] cursor-pointer transition-opacity ".concat(G&&G!==e.id?"opacity-50 hover:opacity-100":"opacity-100"),children:(0,s.jsxs)("div",{className:"w-10 h-10 rounded-full border flex items-center justify-center text-[10px] font-bold transition-all ".concat(G===e.id?"bg-white text-black scale-110 shadow-[0_0_15px_rgba(255,255,255,0.3)]":"rejected"===e.status?"border-[#d90238] text-[#d90238] bg-[#d90238]/10":"approved"===e.status?"border-emerald-500 text-emerald-500 bg-emerald-500/10":"border-amber-500 text-amber-500 bg-amber-500/10"),children:["v",t+1]})},e.id)),ew&&(0,s.jsx)("button",{onClick:()=>B(null),className:"flex flex-col items-center gap-2 group min-w-[60px] cursor-pointer transition-opacity ".concat(null!==G?"opacity-50 hover:opacity-100":"opacity-100"),children:(0,s.jsx)("div",{className:"w-10 h-10 rounded-full border border-dashed border-neutral-700 flex items-center justify-center text-neutral-500 transition-all ".concat(null===G?"border-[#d90238] text-[#d90238] bg-[#d90238]/10":"hover:border-neutral-500 hover:text-white"),children:(0,s.jsx)(D.Z,{size:14})})})]})]}),(0,s.jsx)("div",{className:"flex-1 p-6 flex flex-col overflow-y-auto bg-[#0a0a0a]",children:G?(0,s.jsxs)("div",{className:"space-y-6 animate-in slide-in-from-right-4",children:[(null===(c=f.find(e=>e.id===G))||void 0===c?void 0:c.teacher_comment)&&(0,s.jsxs)("div",{className:"bg-[#d90238]/10 border border-[#d90238]/20 p-4 rounded-xl",children:[(0,s.jsxs)("h4",{className:"text-[#d90238] text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[(0,s.jsx)(R.Z,{size:14})," Instructor Feedback"]}),(0,s.jsxs)("p",{className:"text-neutral-300 text-sm leading-relaxed font-medium",children:['"',null===(d=f.find(e=>e.id===G))||void 0===d?void 0:d.teacher_comment,'"']})]}),(0,s.jsxs)("div",{className:"bg-white/5 border border-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-neutral-500 text-[10px] font-bold uppercase mb-2",children:"Student Note"}),(0,s.jsxs)("p",{className:"text-neutral-400 text-sm italic",children:['"',(null===(x=f.find(e=>e.id===G))||void 0===x?void 0:x.student_message)||"No notes added.",'"']})]}),ev&&G===(null==ep?void 0:ep.id)&&(0,s.jsxs)("button",{onClick:()=>B(null),className:"w-full py-4 bg-[#d90238] hover:bg-[#b0022d] text-white font-bold uppercase tracking-widest text-xs rounded-xl transition-all flex items-center justify-center gap-2 shadow-lg shadow-red-900/20",children:["Start Revision (v",ef.length+1,") ",(0,s.jsx)(L.Z,{size:14})]})]}):!ew&&eb?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-6 border border-amber-500/20 bg-amber-500/5 rounded-xl",children:[(0,s.jsx)(S.Z,{size:32,className:"text-amber-500 mb-4 animate-pulse"}),(0,s.jsx)("h3",{className:"text-white font-bold text-lg",children:"Under Review"}),(0,s.jsx)("p",{className:"text-neutral-500 text-sm mt-2 leading-relaxed",children:"Your instructor is reviewing your submission."})]}):!ew&&eg?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-6 border border-emerald-500/20 bg-emerald-500/5 rounded-xl",children:[(0,s.jsx)(z.Z,{size:32,className:"text-emerald-500 mb-4"}),(0,s.jsx)("h3",{className:"text-white font-bold text-lg",children:"Approved"}),(0,s.jsx)("p",{className:"text-neutral-500 text-sm mt-2 leading-relaxed",children:"You have passed this protocol."})]}):(0,s.jsxs)("div",{className:"flex flex-col h-full animate-in slide-in-from-right-4",children:[(0,s.jsx)("h3",{className:"text-white text-lg font-bold mb-1",children:"Submit Render"}),(0,s.jsxs)("p",{className:"text-neutral-500 text-xs mb-6",children:["Upload your ",P," render for review."]}),(0,s.jsxs)("label",{className:"flex-1 min-h-[150px] border-2 border-dashed rounded-xl flex flex-col items-center justify-center cursor-pointer transition-all mb-6 relative group ".concat(K?"border-[#d90238] bg-[#d90238]/5":"border-white/10 hover:border-[#d90238]/50 hover:bg-white/5"),children:[(0,s.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;(null===(t=e.target.files)||void 0===t?void 0:t[0])&&(H(e.target.files[0]),J(URL.createObjectURL(e.target.files[0])))}}),K?(0,s.jsxs)("div",{className:"relative w-full h-full p-2",children:[(0,s.jsx)("img",{src:K,className:"w-full h-full object-contain rounded-lg"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-lg backdrop-blur-sm",children:(0,s.jsxs)("span",{className:"text-white text-xs font-bold uppercase flex items-center gap-2",children:[(0,s.jsx)(I.Z,{size:14})," Change Image"]})})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center text-neutral-500 group-hover:text-white transition-colors",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-white/5 flex items-center justify-center mb-3 group-hover:bg-[#d90238] transition-colors",children:(0,s.jsx)(D.Z,{size:20})}),(0,s.jsx)("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Click to Upload"})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("textarea",{value:W,onChange:e=>Q(e.target.value),placeholder:"Notes...",className:"w-full bg-black border border-white/10 rounded-xl p-4 text-sm text-white focus:border-[#d90238] focus:outline-none resize-none h-20 placeholder:text-neutral-700"}),(0,s.jsx)("div",{className:"flex justify-center pt-2",children:(0,s.jsx)("button",{onClick:eh,disabled:!K||$,className:"px-8 py-3 bg-[#d90238] hover:bg-[#b0022d] disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold uppercase tracking-widest text-xs rounded-full transition-all flex items-center justify-center gap-2 shadow-[0_0_20px_rgba(217,2,56,0.3)] hover:shadow-[0_0_30px_rgba(217,2,56,0.5)] hover:scale-105 active:scale-95",children:$?(0,s.jsx)(w.Z,{className:"animate-spin",size:16}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.Z,{size:14})," Submit Render"]})})})]})]})})]})]}),"gallery"===F&&(0,s.jsxs)("div",{className:"flex-1 bg-[#020202] p-8 overflow-y-auto animate-in fade-in",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-black text-white tracking-tight",children:"Academy Gallery"}),(0,s.jsx)("p",{className:"text-neutral-500 text-sm mt-2",children:"Explore approved submissions from fellow students."})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6",children:b.map(e=>(0,s.jsxs)("div",{className:"aspect-square bg-[#0a0a0a] border border-white/5 rounded-xl overflow-hidden relative group cursor-pointer hover:border-[#d90238]/50 transition-all",children:[(0,s.jsx)("img",{src:e.render_image_url,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-500"}),(0,s.jsxs)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity p-4 flex flex-col justify-end",children:[(0,s.jsxs)("p",{className:"text-white font-bold text-sm",children:["Assignment ",String(e.assignment_number).padStart(2,"0")]}),(0,s.jsx)("p",{className:"text-[10px] text-[#d90238] font-mono uppercase tracking-widest",children:"Approved Work"})]})]},e.id))})]}),"profile"===F&&(0,s.jsx)("div",{className:"flex-1 bg-[#020202] p-12 overflow-y-auto animate-in fade-in slide-in-from-bottom-4",children:(0,s.jsxs)("div",{className:"max-w-5xl mx-auto space-y-12",children:[(0,s.jsxs)("div",{className:"flex items-center gap-8 border-b border-white/10 pb-12",children:[(0,s.jsx)("div",{className:"w-32 h-32 bg-[#d90238] rounded-full flex items-center justify-center shadow-[0_0_40px_rgba(217,2,56,0.3)]",children:(0,s.jsx)("span",{className:"text-5xl font-black text-white",children:(null===(u=h.full_name)||void 0===u?void 0:u.charAt(0).toUpperCase())||"S"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-4xl font-black text-white tracking-tight",children:h.full_name||"Student"}),(0,s.jsxs)("p",{className:"text-neutral-400 flex items-center gap-2 mt-1",children:[(0,s.jsx)(U.Z,{size:14})," ",h.email]})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsxs)("div",{className:"bg-white/5 border border-white/10 px-4 py-2 rounded-lg flex items-center gap-3",children:[(0,s.jsx)(O.Z,{className:"text-[#d90238]",size:20}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-[10px] text-neutral-500 uppercase tracking-widest font-bold",children:"Class Level"}),(0,s.jsx)("p",{className:"text-white font-bold uppercase",children:h.enrolled_class.replace("_"," ")})]})]}),(0,s.jsxs)("div",{className:"bg-white/5 border border-white/10 px-4 py-2 rounded-lg flex items-center gap-3",children:[(0,s.jsx)(z.Z,{className:"text-emerald-500",size:20}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-[10px] text-neutral-500 uppercase tracking-widest font-bold",children:"Current Assignment"}),(0,s.jsxs)("p",{className:"text-white font-bold",children:["#",h.current_level]})]})]})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-3",children:[(0,s.jsx)(Z.Z,{size:24,className:"text-neutral-500"})," Submission History"]}),(0,s.jsx)("div",{className:"bg-white/5 border border-white/10 rounded-2xl overflow-hidden",children:(0,s.jsxs)("table",{className:"w-full text-left text-sm text-neutral-400",children:[(0,s.jsx)("thead",{className:"text-[10px] uppercase tracking-widest bg-black/40 text-neutral-500 font-bold",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-4",children:"Assignment"}),(0,s.jsx)("th",{className:"px-6 py-4",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-4",children:"Submitted On"}),(0,s.jsx)("th",{className:"px-6 py-4 text-right",children:"Action"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-white/5",children:0===f.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,className:"px-6 py-8 text-center text-neutral-500 italic",children:"No submissions yet."})}):f.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-white/5 transition-colors",children:[(0,s.jsxs)("td",{className:"px-6 py-4 font-bold text-white",children:["#",e.assignment_number]}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-widest px-3 py-1 rounded-full border ".concat("approved"===e.status?"bg-emerald-500/10 text-emerald-500 border-emerald-500/30":"rejected"===e.status?"bg-[#d90238]/10 text-[#d90238] border-[#d90238]/30":"bg-amber-500/10 text-amber-500 border-amber-500/30"),children:e.status})}),(0,s.jsxs)("td",{className:"px-6 py-4 flex items-center gap-2",children:[(0,s.jsx)(T.Z,{size:14})," ",new Date(e.created_at).toLocaleDateString()]}),(0,s.jsx)("td",{className:"px-6 py-4 text-right",children:(0,s.jsx)("button",{onClick:()=>{M("workspace"),B(e.id)},className:"text-[#d90238] hover:text-white hover:underline text-xs font-bold uppercase tracking-widest",children:"View Details"})})]},e.id))})]})})]})]})})]})})]})]})}},1708:function(e,t,r){"use strict";r.d(t,{F:function(){return u},Gm:function(){return c},Kf:function(){return x},Mb:function(){return d},uH:function(){return o},un:function(){return n},x4:function(){return a}});var s=r(7014);let l=e=>new Promise((t,r)=>{let s=new FileReader;s.readAsDataURL(e),s.onload=()=>t(s.result),s.onerror=e=>r(e)}),i=e=>({...e,references:e.ref_interior_url&&e.ref_exterior_url?{interior:e.ref_interior_url,exterior:e.ref_exterior_url}:void 0}),a=async e=>{let{data:t,error:r}=await s.O.from("profiles").select("*").eq("email",e).single();return r||!t?null:i(t)},n=async(e,t,r)=>{try{let a={};if(t){let e=await l(t);a.ref_interior_url=e}if(r){let e=await l(r);a.ref_exterior_url=e}let{data:n,error:o}=await s.O.from("profiles").update(a).eq("id",e).select().single();if(o)return console.error("Upload Error:",o.message),null;return i(n)}catch(e){return console.error("Unexpected Error:",e),null}},o=async()=>{let{data:e}=await s.O.from("profiles").select("*").eq("role","student");return(null==e?void 0:e.map(i))||[]},c=async()=>{let{data:e}=await s.O.from("submissions").select("*");return e||[]},d=async e=>{let{data:t}=await s.O.from("submissions").select("*").eq("student_id",e);return t||[]},x=async(e,t,r,i,a)=>{let n=i?await l(i):"https://via.placeholder.com/800",{error:o}=await s.O.from("submissions").insert({student_id:e,assignment_number:t,reference_image_url:r,render_image_url:n,status:"pending",student_message:a,created_at:new Date().toISOString()});return o&&console.error("Submit Error:",o.message),!o},u=async()=>{let{data:e}=await s.O.from("submissions").select("*").eq("status","approved");return e||[]}},7014:function(e,t,r){"use strict";r.d(t,{O:function(){return n}});var s=r(7688),l=r(9079);let i=l.env.NEXT_PUBLIC_SUPABASE_URL,a=l.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,n=(0,s.eI)(i,a)}},function(e){e.O(0,[530,568,971,69,744],function(){return e(e.s=2456)}),_N_E=e.O()}]);